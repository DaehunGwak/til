---
id: '05'
title: 05. ì—°ê´€ê´€ê³„ ë§¤í•‘ ê¸°ì´ˆ
---

## ëª©í‘œ

- ê°ì²´ì™€ í…Œì´ë¸” ì—°ê´€ê´€ê³„ ì°¨ì´ë¥¼ ì´í•´
- ê°ì²´ ì°¸ì¡°ì™€ í…Œì´ë¸” ì™¸ë˜í‚¤ë¥¼ ë§¤í•‘
- ìš©ì–´ ì´í•´
  - ë°©í–¥(Direction): ë‹¨ë°©í–¥: ì–‘ë°©í–¥
  - ë‹¤ì¤‘ì„±(Multiplicity): N:1, 1:N, 1:1, N:M
  - ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸(Owner): ê°ì²´ ì–‘ë°©í–¥ ì—°ê´€ê³„ëŠ” ê´€ë¦¬ í•„ìš”
    - JPAê³„ì˜ í¬ì¸í„° (Hell yeah!)

## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„

> ê°ì²´ì§€í–¥ ì„¤ê³„ì˜ ëª©í‘œëŠ” ììœ¨ì ì¸ ê°ì²´ë“¤ì˜ í˜‘ë ¥ ê³µë™ì²´ë¥¼ ë§Œë“œëŠ” ê²ƒì´ë‹¤. - ì¡°ì˜í˜¸ (ê°ì²´ì§€í–¥ì˜ ì‚¬ì‹¤ê³¼ ì˜¤í•´)

### ì˜ˆì œ ì‹œë‚˜ë¦¬ì˜¤

- íšŒì›ê³¼ íŒ€
- íšŒì›ì€ í•˜ë‚˜ì˜ íŒ€ì—ë§Œ ì†Œì†ë  ìˆ˜ ìˆìŒ
- íšŒì›ê³¼ íŒ€ì€ ë‹¤ëŒ€ì¼ ê´€ê³„
  - íšŒì›:íŒ€ = N:1

### ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§

- í…Œì´ë¸”ì€ ì™¸ë˜í‚¤ë¡œ ì¡°ì¸
  - ì²« ì˜ˆì‹œì—ì„  Entity zmffotmdp
- ê°ì²´ëŠ” ì°¸ì¡°ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê´€ëœ ê°ì²´ë¥¼ ì°¾ìŒ

### ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ë¡œ ê°œì„ 

> [ì˜ˆì œ ì½”ë“œ](https://github.com/DaehunGwak/study-spring/blob/main/jpa/ex1-hello-jpa/src/main/java/daehun/jpa/hello/mapping/basic/main/ManyToOneMain.java)

## ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì™€ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸

> [ì˜ˆì œ ì½”ë“œ](https://github.com/DaehunGwak/study-spring/blob/main/jpa/ex1-hello-jpa/src/main/java/daehun/jpa/hello/mapping/basic/main/BidrectionalMain.java)

### ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„

- ì–‘ë°©í–¥ ë§¤í•‘
  - í…Œì´ë¸”ì— ì—°ê´€ê´€ê³„ëŠ” í•œìª½ì˜ FKë¡œ ì–‘ë°©í–¥ ê´€ê³„ê°€ í‘œí˜„ ê°€ëŠ¥

```java
@Entity
public class Member {
  ...
  private Team team; // MEMBER í…Œì´ë¸”ì— TEAM_ID FK í•„ë“œê°€ ìˆìŒ
  ...
}

@Entity
public class Team {
  ...
  @OneToMany(mappedBy = "team") // ë³€ìˆ˜ëª… ê¸°ì…
  private List<Member> members = new ArrayList<>(); // TEAM í…Œì´ë¸”ì—” FK ì •ë³´ê°€ ì—†ìŒ
  ...
}
```

- ì–‘ë°©í–¥ì´ ì¢‹ì€ê°€?
  - ì™ ë§Œí•˜ë©´ ë‹¨ë°©í–¥ì´ ëœë³µì¡í•˜ê³  ì¢‹ìŒ

### ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ ğŸ˜­

- ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ê³¼ `mappedBy`
  - mappedBy = JPAì˜ ë©˜íƒˆë¶•ê´´ ë‚œì´ë„
  - ì²˜ìŒì— ì´í•´í•˜ê¸° ì–´ë ¤ì›€
  - ê°ì²´ì™€ í…Œì´ë¸”ê°„ì— ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” ì°¨ì´ë¥¼ ì´í•´í•˜ë©´ ë„ì›€

#### ê°ì²´ì™€ í…Œì´ë¸”ì´ ê´€ê³„ë¥¼ ë§ºëŠ” ì°¨ì´

- ê°ì²´ ì—°ê´€ê´€ê³„ í‚¤í¬ì¸íŠ¸ 2ê°œ
  - íšŒì› -> íŒ€ (team ë©¤ë²„ ë³€ìˆ˜) (ë‹¨ë°©í–¥)
  - íŒ€ -> íšŒì› (members ë©¤ë²„ ë³€ìˆ˜) (ë‹¨ë°©í–¥)
- í…Œì´ë¸” ì—°ê´€ê´€ê³„ í‚¤í¬ì¸íŠ¸
  - MEMBER.TEAM_ID (FK) (ì–‘ë°©í–¥)
- `ê°ì²´ì˜ ë‹¨ë°©í–¥ ê´€ê³„ ë‘˜ì¤‘ í•˜ë‚˜ë¡œ ê´€ë¦¬ë¥¼ í•´ì•¼í•¨`
  - Member.team ì„ ë°”ê¿€ì§€ Team.members ë¥¼ ë°”ê¿€ì§€ ê³ ë¯¼ì´ ë¨
  - DB ì…ì¥ì€ MEMBER.TEAM_ID FK í•˜ë‚˜ë§Œ ê´€ë¦¬í•˜ë©´ ë¨

#### ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ (Owner)

- ì–‘ë°©í–¥ ë§¤í•‘ ê·œì¹™
  - ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬ í•  ìˆ˜ ìˆìŒ (ë“±ë¡, ìˆ˜ì •)
  - ì£¼ì¸ì´ ì•„ë‹Œìª½ì€ ì½ê¸°ë§Œ ê°€ëŠ¥
  - ì£¼ì¸ì€ `mappedBy` ì†ì„± ì‚¬ìš© X
- ëˆ„êµ¬ë¥¼ ì£¼ì¸ìœ¼ë¡œ í•˜ëŠ”ê°€?
  - ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³ì„ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ì (`Member.team` ì´ ì£¼ì¸)
    - ë°˜ëŒ€ë¡œí•˜ë©´ ì´í•´ê°€ í˜ë“¦ (Team ê°ì²´ë¥¼ ìˆ˜ì •í–ˆëŠ”ë° MEMBER í…Œì´ë¸”ì´ ë³€í•˜ëŠ” í—·ê°ˆë¦¬ëŠ” ìƒí™©ì´ ë°œìƒ)
    - ì„±ëŠ¥ ì´ìŠˆë„ ìˆìŒ
  - ê°€ì§œ ë§¤í•‘ - ì£¼ì¸ì˜ ë°˜ëŒ€í¸ (`Team.members`)

### ì–‘ë°©í–¥ ë§¤í•‘ì—ì„œ ê°€ì¥ ë§ì´ í•˜ëŠ” ì‹¤ìˆ˜

- ë§¤í•‘ì‹œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì— ê°’ì„ ì…ë ¥í•´ì•¼ í•œë‹¤.
- ìˆœìˆ˜ ê°ì²´ ìƒíƒœë¥¼ ê³ ë ¤í•´ì„œ í•­ìƒ ì–‘ìª½ì— ê°’ì„ ì„¤ì •í•˜ì
- ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œë¥¼ ìƒì„±í•˜ì
  - [ì‹¤ìŠµ ì½”ë“œ](https://github.com/DaehunGwak/study-spring/blob/main/jpa/ex1-hello-jpa/src/main/java/daehun/jpa/hello/mapping/basic/main/BidrectionalMistakesMain.java)
  - ê°€ê¸‰ì  í•œìª½ì—ì„œë§Œ êµ¬í˜„í•˜ì (ë‘˜ë‹¤ ìˆìœ¼ë©´ ê³ ë ¤ì‚¬í•­ì´ ë§ì•„ì§)
- ì–‘ë°©í–¥ ë§¤í•‘ì‹œ ë¬´í•œ ë£¨í”„ë¥¼ ì¡°ì‹¬í•˜ì
  - toString(), lombok, JSON ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬
  - Entity í´ë˜ìŠ¤ëŠ” Responseë¡œ ì§ì ‘ ì“°ì§€ ë§ì
    - DAOë¥¼ DTOë¡œ ë³€í™˜í•´ì„œ ë°˜í™˜í•˜ì

### ì–‘ë°©í–¥ ë§¤í•‘ ì •ë¦¬

- ë‹¨ë°©í–¥ ë§¤í•‘ë§Œìœ¼ë¡œë„ ì´ë¯¸ ì—°ê´€ê´€ê³„ ë§¤í•‘ì€ ì™„ë£Œ
- ì–‘ë°©í–¥ ë§¤í•‘ì€ ë°˜ëŒ€ ë°©í–¥ ì¡°íšŒ (ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰) ê¸°ëŠ¥ ì¶”ê°€ì¼ ë¿
- JPQLì—ì„œ ì—­ë°©í–¥ìœ¼ë¡œ íƒìƒ‰í•  ì¼ì´ ë§ìŒ
- ì–‘ë°©í–¥ì€ í•„ìš”í• ë•Œë§Œ ì¶”ê°€í•˜ì
- ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ ì™¸ë˜í‚¤ì˜ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •í•´ì•¼í•œë‹¤

## ëŠë‚€ì 

- ë‹¨ë°©í–¥ìœ¼ë¡œ ì„¤ì • (ê°ì²´ ì…ì¥ì—ì„œ ì–‘ë°©í–¥ìœ¼ë¡œ ìˆìœ¼ë©´ ë³µì¡ë„ê°€ ë„ˆë¬´ ì˜¬ë¼ê°)
  - ì´í›„ í•„ìš”í•˜ê²Œ ë˜ì—ˆì„ ë•Œ, ì–´ì©” ìˆ˜ ì—†ì´ ì–‘ë°©í–¥ìœ¼ë¡œ ë§Œë“¦
  - ì´ë•Œ ì—°ê´€ê´€ê³„ ì£¼ì¸ ì„¤ì •ì„ ì •í™•íˆ
- ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ -> ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ëŠ” ì—”í‹°í‹°ê°€ ì£¼ì¸
  - ë‹¤ë¥¸ ê°ì²´ëŠ” `mappedBy` ë¡œ ì£¼ì¸ì´ ì•„ë‹ˆë¼ëŠ” ì„¤ì •ì„ í•´ì¤˜ì•¼ í•¨